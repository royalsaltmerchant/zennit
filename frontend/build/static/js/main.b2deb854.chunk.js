(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{115:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(34),s=n.n(r),c=(n(87),n(9)),o=n.n(c),i=n(12),l=n(14),u=n(10),d=n.n(u),j=n(25),h=n(26),m=n(82),p=n(37),b="FETCH_POSTS",O="FETCH_USER",x="FETCH_COMMENTS",f={items:[],item:{}},g={items:[],item:{}},v={item:{}},y=Object(h.c)({posts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:return Object(p.a)(Object(p.a)({},e),{},{items:t.payload});default:return e}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O:return Object(p.a)(Object(p.a)({},e),{},{item:t.payload});default:return e}},comments:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return Object(p.a)(Object(p.a)({},e),{},{items:t.payload});default:return e}}}),w=[m.a],k=Object(h.e)(y,{},Object(h.d)(h.a.apply(void 0,w))),S=n(8),N=n(13),C=n(16),T=n(17),P=n(20),I=n(19),_=(n(24),n(50)),z=n(33),D=n(35),M=n(60),A=n(1),U=function(e){Object(P.a)(n,e);var t=Object(I.a)(n);function n(e){return Object(C.a)(this,n),t.call(this,e)}return Object(T.a)(n,[{key:"renderNavbarAccountOptions",value:function(){return this.props.authorization?Object(A.jsxs)(z.a,{children:[Object(A.jsx)(D.a,{children:Object(A.jsx)(z.a.Link,{as:S.b,to:"/new_post",children:"New Post"})}),Object(A.jsx)(D.a,{children:Object(A.jsx)(z.a.Link,{as:S.b,to:"/account",children:"Account"})}),Object(A.jsx)(D.a,{children:Object(A.jsx)(z.a.Link,{as:S.b,to:"/logout",children:"Logout"})})]}):Object(A.jsxs)(z.a,{children:[Object(A.jsx)(D.a,{children:Object(A.jsx)(z.a.Link,{as:S.b,to:"/login",children:"Login"})}),Object(A.jsx)(D.a,{children:Object(A.jsx)(z.a.Link,{as:S.b,to:"/register",children:"Register"})})]})}},{key:"render",value:function(){return Object(A.jsx)("div",{children:Object(A.jsx)(_.a,{expand:"md",bg:"color",variant:"dark",collapseOnSelect:!0,children:Object(A.jsxs)(M.a,{children:[Object(A.jsx)("img",{width:30,height:30,className:"zencircle",src:"https://zennitapp.s3.amazonaws.com/zencircle.png",alt:"zennit zen circle"}),Object(A.jsx)(_.a.Brand,{as:S.b,className:"mr-4",to:"/home",children:"Zennit"}),Object(A.jsx)(_.a.Toggle,{"aria-controls":"navbarToggle"}),Object(A.jsxs)(_.a.Collapse,{id:"navbarToggle",children:[Object(A.jsx)(z.a,{className:"mr-auto",children:Object(A.jsx)(D.a,{children:Object(A.jsx)(z.a.Link,{as:S.b,to:"/home",children:"Home"})})}),this.renderNavbarAccountOptions()]})]})})})}}]),n}(a.Component),L=function(e){Object(P.a)(n,e);var t=Object(I.a)(n);function n(){return Object(C.a)(this,n),t.apply(this,arguments)}return Object(T.a)(n,[{key:"render",value:function(){return Object(A.jsx)("div",{children:Object(A.jsx)("h1",{children:"About Page"})})}}]),n}(a.Component),E=n(51),B=function(e){Object(P.a)(n,e);var t=Object(I.a)(n);function n(){return Object(C.a)(this,n),t.apply(this,arguments)}return Object(T.a)(n,[{key:"render",value:function(){return Object(A.jsx)("div",{className:"col-md-4",children:Object(A.jsxs)("div",{className:"content-section",children:[Object(A.jsx)("h3",{children:"Expedients"}),Object(A.jsxs)("div",{className:"text-muted",children:["Currently Under Construction",Object(A.jsxs)(E.a,{children:[Object(A.jsx)(E.a.Item,{children:Object(A.jsx)(S.b,{to:"/about",children:"About"})}),Object(A.jsx)(E.a.Item,{children:Object(A.jsx)(S.b,{to:"/recent_comments",children:"Recent Comments"})}),Object(A.jsx)(E.a.Item,{children:Object(A.jsx)(S.b,{to:"/users",children:"Users"})})]})]})]})})}}]),n}(a.Component),H=n(5),q=n(11);function G(e){var t=Object(N.f)();function n(){return(n=Object(i.a)(o.a.mark((function e(n){var a,r,s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),t.push("/login"),a=n.target.username.value.trim(),r=n.target.email.value.trim(),s=n.target.password.value,e.prev=5,e.next=8,d()({method:"post",url:"/api/register",data:{username:a,email:r,password:s}});case 8:c=e.sent,console.log(c),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[5,12]])})))).apply(this,arguments)}return Object(A.jsxs)("div",{children:[Object(A.jsxs)("div",{className:"content-section",children:[Object(A.jsx)("legend",{className:"border-bottom mb-4",children:"Join Zennit!"}),Object(A.jsxs)(H.a,{onSubmit:function(e){return function(e){return n.apply(this,arguments)}(e)},children:[Object(A.jsxs)(H.a.Group,{controlId:"username",children:[Object(A.jsx)(H.a.Label,{children:"Username"}),Object(A.jsx)(H.a.Control,{required:!0,size:"lg",type:"username",placeholder:"Username"})]}),Object(A.jsxs)(H.a.Group,{controlId:"email",children:[Object(A.jsx)(H.a.Label,{children:"Email"}),Object(A.jsx)(H.a.Control,{required:!0,size:"lg",type:"email",placeholder:"Enter email"}),Object(A.jsx)(H.a.Text,{className:"text-muted",children:"We'll never share your email with anyone else."})]}),Object(A.jsxs)(H.a.Group,{controlId:"password",children:[Object(A.jsx)(H.a.Label,{children:"Password"}),Object(A.jsx)(H.a.Control,{required:!0,size:"lg",type:"password",placeholder:"Password","aria-describedby":"passwordHelpBlock"}),Object(A.jsx)(H.a.Text,{id:"passwordHelpBlock",muted:!0,children:"Your password must be 8-20 characters long, contain letters and numbers, and must not contain spaces, special characters, or emoji."})]}),Object(A.jsx)(q.a,{variant:"outline-info",type:"submit",children:"Sign Up"})]})]}),Object(A.jsx)("div",{className:"border-top pt-3",children:Object(A.jsxs)("small",{className:"text-muted",children:["Already Have An Account? ",Object(A.jsx)(S.b,{className:"ml-2",to:"/login",children:"Sign In"})]})})]})}var Y=n(18);function V(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=(t[0],t[1]),r=Object(a.useState)(!1),s=Object(l.a)(r,2),c=s[0],u=s[1],j=Object(a.useState)("warning"),h=Object(l.a)(j,2),m=h[0],p=h[1],b=Object(a.useState)("Something went wrong, please try again later!"),O=Object(l.a)(b,2),x=O[0],f=O[1],g=Object(N.f)();function v(){return(v=Object(i.a)(o.a.mark((function e(t){var a,r,s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=t.target.email.value.trim(),r=t.target.password.value,e.prev=3,e.next=6,d()({method:"post",url:"/api/login",data:{email:a,password:r}});case 6:s=e.sent,console.log(s),200===s.status?(c=s.data.token,localStorage.setItem("token","Bearer "+c),localStorage.setItem("loginMessage",!0),n(!0),g.replace("/"),g.go("/")):(n(!1),u(!0),p("warning"),f("Something went wrong, please try again later!")),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(3),n(!1),console.log(e.t0.response),400===e.t0.response.status?(u(!0),p("warning"),f("Incorrect Email or Password")):(u(!0),p("danger"),f("Something went wrong, please try again later!"));case 16:case"end":return e.stop()}}),e,null,[[3,11]])})))).apply(this,arguments)}return Object(a.useEffect)((function(){c&&setTimeout((function(){u(!1)}),5e3)})),Object(A.jsxs)("div",{children:[function(){if(c)return Object(A.jsx)(Y.a,{variant:m,children:x})}(),Object(A.jsxs)("div",{className:"content-section",children:[Object(A.jsx)("legend",{className:"border-bottom mb-4",children:"Login"}),Object(A.jsxs)(H.a,{onSubmit:function(e){return function(e){return v.apply(this,arguments)}(e)},children:[Object(A.jsxs)(H.a.Group,{controlId:"email",children:[Object(A.jsx)(H.a.Label,{children:"Email"}),Object(A.jsx)(H.a.Control,{required:!0,size:"lg",type:"email",placeholder:"Account Email"})]}),Object(A.jsxs)(H.a.Group,{controlId:"password",children:[Object(A.jsx)(H.a.Label,{children:"Password"}),Object(A.jsx)(H.a.Control,{required:!0,size:"lg",type:"password",placeholder:"Account Password"})]}),Object(A.jsx)(q.a,{variant:"outline-info",type:"submit",children:"Login"}),Object(A.jsx)("small",{className:"text-muted ml-2",children:Object(A.jsx)(S.b,{to:"/forgot_password",children:"Forgot Password?"})})]})]}),Object(A.jsx)("div",{className:"border-top pt-3",children:Object(A.jsxs)("small",{className:"text-muted",children:["Need An Account? ",Object(A.jsx)(S.b,{className:"ml-2",to:"/register",children:"Sign Up Here!"})]})})]})}function R(){var e=Object(N.f)();return Object(a.useEffect)((function(){localStorage.removeItem("token"),localStorage.removeItem("loginMessage"),e.push("/"),e.go("/")})),Object(A.jsx)("div",{})}var W=function(){return function(e){d()({method:"get",url:"/api/get_user",headers:{"x-access-token":localStorage.getItem("token")}}).then((function(t){e({type:O,payload:t.data})}))}},F=n(23),J=function(e){Object(P.a)(n,e);var t=Object(I.a)(n);function n(e){var a;return Object(C.a)(this,n),(a=t.call(this,e)).state={alert:!1,alertText:"Something went wrong, please try again later!",alertType:"warning",submission:!1},a}return Object(T.a)(n,[{key:"componentDidMount",value:function(){this.props.fetchUser()}},{key:"componentDidUpdate",value:function(){var e=this;this.state.submission&&(this.props.fetchUser(),this.setState({submission:!1})),this.state.alert&&setTimeout((function(){e.setState({alert:!1})}),5e3)}},{key:"renderAlert",value:function(){var e=this.state,t=e.alert,n=e.alertText,a=e.alertType;if(t)return Object(A.jsx)(Y.a,{variant:a,children:n})}},{key:"handleSubmit",value:function(){var e=Object(i.a)(o.a.mark((function e(t){var n,a,r,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=t.target.email.value.trim(),a=t.target.username.value.trim(),r=t.target.imageUpload.files[0],(s=new FormData(t.target)).append("username",a),s.append("email",n),s.append("image_file",r),e.prev=8,e.next=11,d()({headers:{"x-access-token":localStorage.getItem("token"),"Content-Type":"multipart/form-data"},method:"post",url:"/api/update_user",data:s});case 11:200===e.sent.status?this.setState({alert:!0,alertType:"success",alertText:"Successfully updated account info!",submission:!0}):this.setState({alert:!0}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(8),e.t0.response?(console.log(e.t0.response),400===e.t0.response.status?this.setState({alert:!0,alertType:"danger",alertText:"There was an issue updating your information, please try again later!"}):500===e.t0.response.status&&this.setState({alert:!0})):this.setState({alert:!0});case 18:case"end":return e.stop()}}),e,this,[[8,15]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.user;return Object(A.jsxs)("div",{children:[this.renderAlert(),Object(A.jsxs)("div",{className:"content-section",children:[Object(A.jsxs)(F.a,{children:[Object(A.jsx)("img",{width:64,height:64,className:"rounded-circle account-img",src:"https://zennitapp.s3.amazonaws.com/".concat(t.image_file),alt:"Current User Profile Avatar"}),Object(A.jsxs)(F.a.Body,{children:[Object(A.jsx)("h2",{className:"account-heading",children:t.username}),Object(A.jsx)("p",{className:"text-secondary",children:t.email})]})]}),Object(A.jsx)("legend",{className:"border-bottom mb-4",children:"Account Info"}),Object(A.jsxs)(H.a,{onSubmit:function(t){return e.handleSubmit(t)},children:[Object(A.jsxs)(H.a.Group,{controlId:"email",children:[Object(A.jsx)(H.a.Label,{children:"Email"}),Object(A.jsx)(H.a.Control,{size:"lg",type:"email",placeholder:"New Email"})]}),Object(A.jsxs)(H.a.Group,{controlId:"username",children:[Object(A.jsx)(H.a.Label,{children:"Username"}),Object(A.jsx)(H.a.Control,{size:"lg",type:"username",placeholder:"New Username"})]}),Object(A.jsxs)(H.a.Group,{children:[Object(A.jsx)(H.a.File,{id:"imageUpload",label:"Update Profile Picture",accept:".png, .jpg, .jpeg","aria-describedby":"imageHelpBlock",name:"image_file"}),Object(A.jsx)(H.a.Text,{id:"imagedHelpBlock",muted:!0,children:"Your image must be a common format such as: .png .jpg .jpeg"})]}),Object(A.jsx)(q.a,{variant:"outline-info",type:"submit",children:"Update"})]})]})]})}}]),n}(a.Component),Z=Object(j.b)((function(e){return{user:e.users.item}}),{fetchUser:W})(J),K=function(){return function(e){d()({method:"get",url:"/api/posts"}).then((function(t){e({type:b,payload:t.data})}))}},Q=function(){return function(e){d()({method:"get",url:"/api/comments"}).then((function(t){e({type:x,payload:t.data})}))}},X=function(e){Object(P.a)(n,e);var t=Object(I.a)(n);function n(e){var a;return Object(C.a)(this,n),(a=t.call(this,e)).state={commentsViewable:4,alert:!1,alertType:"warning",alertText:"Something went wrong, please try again later!"},a}return Object(T.a)(n,[{key:"handleSubmit",value:function(){var e=Object(i.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props.post,a=t.target.comment.value.trim(),t.preventDefault(),e.prev=3,e.next=6,d()({headers:{"x-access-token":localStorage.getItem("token")},method:"post",url:"/api/new_comment",data:{post_id:n,content:a}});case 6:201===e.sent.status?(this.props.fetchComments(),this.setState({alert:!0,alertType:"success",alertText:"Comment Successfully Created!"})):this.setState({alert:!0}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),e.t0.response?(console.log(e.t0.response),400===e.t0.response.status?this.setState({alert:!0,alertType:"warning",alertText:"Please login to comment!"}):500===e.t0.response.status&&this.setState({alert:!0,alertType:"warning",alertText:"Something went wrong, please try again later!"})):this.setState({alert:!0,alertType:"warning",alertText:"Something went wrong, please try again later!"});case 13:case"end":return e.stop()}}),e,this,[[3,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"renderAlert",value:function(){var e=this,t=this.state,n=t.alert,a=t.alertText,r=t.alertType;if(n)return setTimeout((function(){e.setState({alert:!1,alertType:"warning",alertText:"Please login to comment!"})}),5e3),Object(A.jsx)(Y.a,{variant:r,children:a})}},{key:"render",value:function(){var e=this,t=this.props.user;return Object(A.jsxs)("div",{children:[this.renderAlert(),Object(A.jsxs)(F.a,{children:[Object(A.jsx)("img",{className:"rounded-circle article-img",src:"https://zennitapp.s3.amazonaws.com/".concat(t.image_file),alt:"current user"}),Object(A.jsxs)(H.a,{onSubmit:function(t){return e.handleSubmit(t)},children:[Object(A.jsx)(H.a.Group,{controlId:"comment",children:Object(A.jsx)(H.a.Control,{required:!0,as:"textarea",size:"md",cols:"55",type:"comment",placeholder:"Expound the dharma..."})}),Object(A.jsx)(q.a,{variant:"outline-info",type:"submit",children:"Comment"})]})]})]})}}]),n}(a.Component),$=Object(j.b)((function(e){return{comments:e.comments.items}}),{fetchComments:Q})(X),ee=function(e){Object(P.a)(a,e);var t=Object(I.a)(a);function a(e){var n;return Object(C.a)(this,a),(n=t.call(this,e)).state={postsViewable:4,commentsViewable:4,userIs:!1},n}return Object(T.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.fetchPosts,n=e.fetchComments;t(),n()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.user,a=t.fetchUser,r=(t.fetchComments,t.authorization);t.comments;e.authorization!==r&&a(),e.user!==n&&this.renderNewComment()}},{key:"renderDatePosted",value:function(e){var t=n(66)(e).format("dddd, MMMM Do YYYY, h:mm:ss a");return Object(A.jsx)("small",{className:"text-muted",children:t})}},{key:"renderArticleContent",value:function(e,t){return e.length>1e3?Object(A.jsxs)("div",{children:[Object(A.jsx)("p",{className:"article-content",children:e.substr(0,1e3)}),Object(A.jsx)(S.b,{className:"mr-2",to:"/post/".concat(t),children:"Read More"})]}):Object(A.jsx)("div",{children:Object(A.jsx)("p",{className:"article-content",children:e})})}},{key:"handleDeleteComment",value:function(){var e=Object(i.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d()({headers:{"x-access-token":localStorage.getItem("token")},method:"post",url:"/api/delete_comment",data:{comment_id:t}});case 3:200===e.sent.status?(this.props.fetchComments(),this.setState({alert:!0,alertType:"success",alertText:"Comment Successfully Deleted!"})):this.setState({alert:!0}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0.response),this.setState({alert:!0});case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"renderNewComment",value:function(e){var t=this.props.user;if(0!==Object.keys(t).length)return Object(A.jsx)($,{post:e,user:t})}},{key:"renderCommentsLength",value:function(e){var t=this.props.comments.filter((function(t){if(t.post_id==e)return!0}));return Object(A.jsxs)("p",{children:["Comments(",t.length,")"]})}},{key:"renderCommentEditButtons",value:function(e,t){var n=this;if(this.props.user.username===e&&localStorage.getItem("token"))return Object(A.jsx)(q.a,{className:"ml-3",onClick:function(){return n.handleDeleteComment(t)},variant:"outline-danger",size:"sm",children:Object(A.jsx)("span",{children:"\xd7"})})}},{key:"renderComments",value:function(e){var t=this,n=this.props.comments,a=this.state.commentsViewable;return n.filter((function(t){if(t.post_id==e)return!0})).map((function(e){return Object(A.jsx)(F.a,{children:Object(A.jsxs)("div",{className:"comment-content",children:[Object(A.jsx)(S.b,{className:"mr-2",to:"/user_posts/".concat(e["user.username"]),children:e["user.username"]}),t.renderDatePosted(e.date_posted),t.renderCommentEditButtons(e["user.username"],e.id),Object(A.jsx)("hr",{}),Object(A.jsx)("p",{children:e.content})]})},e.id)})).slice(0,a)}},{key:"renderProfileImage",value:function(e){return Object(A.jsx)("img",{className:"rounded-circle article-img",src:"https://zennitapp.s3.amazonaws.com/".concat(e),alt:""})}},{key:"renderPostContent",value:function(){var e=this,t=this.state.postsViewable;this.props.comments;return this.props.posts.map((function(t){return Object(A.jsxs)("div",{children:[Object(A.jsxs)(F.a,{className:"content-section",children:[e.renderProfileImage(t["user.image_file"]),Object(A.jsxs)(F.a.Body,{children:[Object(A.jsxs)("div",{className:"article-metadata",children:[Object(A.jsx)(S.b,{className:"mr-2",to:"/user_posts/".concat(t["user.username"]),children:t["user.username"]}),e.renderDatePosted(t.date_posted)]}),Object(A.jsx)("h2",{children:Object(A.jsx)(S.b,{className:"article-title",to:"/post/".concat(t.id),children:t.title})}),e.renderArticleContent(t.content,t.id)]})]}),e.renderCommentsLength(t.id),e.renderComments(t.id),e.renderNewComment(t.id),Object(A.jsx)("hr",{})]},t.id)})).slice(0,t)}},{key:"renderMorePosts",value:function(e){var t=e.target,n=this.state.postsViewable,a=this.props.posts;t.scrollHeight-t.scrollTop===t.clientHeight&&n!==a.length&&this.setState({postsViewable:n+2},(function(){console.log(n)}))}},{key:"render",value:function(){var e=this;return Object(A.jsx)("div",{className:"scrolling",onScroll:function(t){return e.renderMorePosts(t)},children:this.renderPostContent()})}}]),a}(a.Component),te=Object(j.b)((function(e){return{posts:e.posts.items,user:e.users.item,comments:e.comments.items}}),{fetchPosts:K,fetchUser:W,fetchComments:Q})(ee),ne=function(e){Object(P.a)(a,e);var t=Object(I.a)(a);function a(e){var n;return Object(C.a)(this,a),(n=t.call(this,e)).state={postsViewable:2},n}return Object(T.a)(a,[{key:"componentDidMount",value:function(){this.props.fetchPosts()}},{key:"renderDatePosted",value:function(e){var t=n(66)(e).format("dddd, MMMM Do YYYY, h:mm:ss a");return Object(A.jsx)("small",{className:"text-muted",children:t})}},{key:"renderArticleContent",value:function(e,t){return e.length>1e3?Object(A.jsxs)("div",{children:[Object(A.jsx)("p",{className:"article-content",children:e.substr(0,1e3)}),Object(A.jsx)(S.b,{className:"mr-2",to:"/post/".concat(t),children:"Read More"})]}):Object(A.jsx)("div",{children:Object(A.jsx)("p",{className:"article-content",children:e})})}},{key:"renderProfileImage",value:function(e){return Object(A.jsx)("img",{className:"rounded-circle article-img",src:"https://zennitapp.s3.amazonaws.com/".concat(e),alt:""})}},{key:"renderPostContent",value:function(){var e=this,t=this.state.postsViewable,n=this.props.match.params.username;return this.props.posts.filter((function(e){if(e["user.username"]===n)return!0})).map((function(t){return Object(A.jsxs)(F.a,{className:"content-section",children:[e.renderProfileImage(t["user.image_file"]),Object(A.jsxs)(F.a.Body,{children:[Object(A.jsxs)("div",{className:"article-metadata",children:[Object(A.jsx)(S.b,{className:"mr-2",to:"/user_posts/".concat(t["user.username"]),children:t["user.username"]}),e.renderDatePosted(t.date_posted)]}),Object(A.jsx)("h2",{children:Object(A.jsx)(S.b,{className:"article-title",to:"/post/".concat(t.id),children:t.title})}),e.renderArticleContent(t.content,t.id)]})]},t.id)})).slice(0,t)}},{key:"renderMorePosts",value:function(e){var t=e.target,n=this.state.postsViewable,a=this.props.posts;t.scrollHeight-t.scrollTop===t.clientHeight&&n!==a.length&&this.setState({postsViewable:n+2},(function(){console.log(n)}))}},{key:"render",value:function(){var e=this,t=this.props.match.params.username;return Object(A.jsxs)("div",{className:"scrolling",onScroll:function(t){return e.renderMorePosts(t)},children:[Object(A.jsx)("h1",{children:t}),this.renderPostContent()]})}}]),a}(a.Component),ae=Object(h.d)(N.h,Object(j.b)((function(e){return{posts:e.posts.items}}),{fetchPosts:K}))(ne),re=n(46),se=function(e){Object(P.a)(a,e);var t=Object(I.a)(a);function a(e){var n;return Object(C.a)(this,a),(n=t.call(this,e)).state={modalToggle:!1,alert:!1,alertText:"Something went wrong, please try again later!",alertType:"warning"},n}return Object(T.a)(a,[{key:"componentDidMount",value:function(){this.props.fetchPosts(),localStorage.getItem("token")&&this.props.fetchUser()}},{key:"componentDidUpdate",value:function(){var e=this;this.state.alert&&setTimeout((function(){e.setState({alert:!1})}),5e3)}},{key:"renderAlert",value:function(){var e=this.state,t=e.alert,n=e.alertType,a=e.alertText;if(t)return Object(A.jsx)(Y.a,{variant:n,children:a})}},{key:"handleModalToggle",value:function(){var e=this.state.modalToggle;this.setState({modalToggle:!e})}},{key:"handleDeletePost",value:function(){var e=Object(i.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params.id,e.prev=1,e.next=4,d()({headers:{"x-access-token":localStorage.getItem("token")},method:"post",url:"/api/delete_post",data:{post_id:t}});case 4:n=e.sent,console.log(n),200===n.status?(localStorage.setItem("deletePost",!0),this.props.history.replace("/")):this.setState({alert:!0}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0.response),this.setState({alert:!0});case 13:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"renderDatePosted",value:function(e){var t=n(66)(e).format("dddd, MMMM Do YYYY, h:mm:ss a");return Object(A.jsx)("small",{className:"text-muted",children:t})}},{key:"renderProfileImage",value:function(e){return Object(A.jsx)("img",{className:"rounded-circle article-img",src:"https://zennitapp.s3.amazonaws.com/".concat(e),alt:""})}},{key:"renderEditButtons",value:function(e){var t=this,n=this.props.user.username,a=this.props.match.params.id;if(n===e&&localStorage.getItem("token"))return Object(A.jsxs)("div",{children:[Object(A.jsx)(q.a,{as:S.b,className:"mt-1 mb-1",size:"sm",to:"/update/post/".concat(a),children:"Update"}),Object(A.jsx)(q.a,{onClick:function(){return t.handleModalToggle()},className:"m-1",variant:"danger",size:"sm",children:"Delete"})]})}},{key:"renderPostContent",value:function(){var e=this,t=this.props.match.params.id;return this.props.posts.filter((function(e){if(e.id==t)return!0})).map((function(t){return Object(A.jsxs)(F.a,{className:"content-section",children:[e.renderProfileImage(t["user.image_file"]),Object(A.jsxs)(F.a.Body,{children:[Object(A.jsxs)("div",{className:"article-metadata",children:[Object(A.jsx)(S.b,{className:"mr-2",to:"/user_posts/".concat(t["user.username"]),children:t["user.username"]}),e.renderDatePosted(t.date_posted),e.renderEditButtons(t["user.username"])]}),Object(A.jsx)("h2",{children:Object(A.jsx)(S.b,{className:"article-title",to:"/post/".concat(t.id),children:t.title})}),Object(A.jsx)("p",{className:"article-content",children:t.content})]})]},t.id)}))}},{key:"render",value:function(){var e=this,t=this.state.modalToggle;return Object(A.jsxs)("div",{children:[this.renderAlert(),this.renderPostContent(),Object(A.jsx)(re.a,{className:"fade",show:t,children:Object(A.jsxs)(re.a.Dialog,{children:[Object(A.jsxs)(re.a.Header,{children:[Object(A.jsx)(re.a.Title,{children:"Delete Post?"}),Object(A.jsx)(q.a,{onClick:function(){return e.handleModalToggle()},variant:"close",children:Object(A.jsx)("span",{children:"\xd7"})})]}),Object(A.jsxs)(re.a.Footer,{children:[Object(A.jsx)(q.a,{onClick:function(){return e.handleModalToggle()},variant:"secondary",children:"Close"}),Object(A.jsx)(q.a,{onClick:function(){return e.handleDeletePost()},variant:"danger",value:"delete",type:"submit",children:"Delete"})]})]})})]})}}]),a}(a.Component),ce=Object(h.d)(N.h,Object(j.b)((function(e){return{posts:e.posts.items,user:e.users.item}}),{fetchPosts:K,fetchUser:W}))(se);function oe(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)("Something went wrong, please try again later!"),c=Object(l.a)(s,2),u=c[0],j=(c[1],Object(N.f)());function h(){return(h=Object(i.a)(o.a.mark((function e(t){var n,a,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=t.target.title.value.trim(),a=t.target.content.value.trim(),e.prev=3,e.next=6,d()({headers:{"x-access-token":localStorage.getItem("token")},method:"post",url:"/api/new_post",data:{title:n,content:a}});case 6:s=e.sent,console.log(s),201===s.status?(localStorage.setItem("newPost",!0),j.replace("/")):r(!0),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(3),console.log(e.t0.response),r(!0);case 15:case"end":return e.stop()}}),e,null,[[3,11]])})))).apply(this,arguments)}return Object(a.useEffect)((function(){n&&n&&setTimeout((function(){r(!1)}),5e3)})),Object(A.jsxs)("div",{children:[function(){if(n)return Object(A.jsx)(Y.a,{variant:"danger",children:u})}(),Object(A.jsxs)("div",{className:"content-section",children:[Object(A.jsx)("legend",{className:"border-bottom mb-4",children:"New Post"}),Object(A.jsxs)(H.a,{onSubmit:function(e){return function(e){return h.apply(this,arguments)}(e)},children:[Object(A.jsxs)(H.a.Group,{controlId:"title",children:[Object(A.jsx)(H.a.Label,{children:"Title"}),Object(A.jsx)(H.a.Control,{required:!0,size:"lg",type:"title",placeholder:"Post Title"})]}),Object(A.jsxs)(H.a.Group,{controlId:"content",children:[Object(A.jsx)(H.a.Label,{children:"Content"}),Object(A.jsx)(H.a.Control,{required:!0,as:"textarea",rows:"10",size:"lg",type:"content",placeholder:"Post Content"})]}),Object(A.jsx)(q.a,{variant:"outline-info",type:"submit",children:"Post"})]})]})]})}var ie=function(e){Object(P.a)(n,e);var t=Object(I.a)(n);function n(e){var a;return Object(C.a)(this,n),(a=t.call(this,e)).state={modalToggle:!1,alert:!1,alertText:"Something went wrong, please try again later!",alertType:"warning"},a}return Object(T.a)(n,[{key:"componentDidMount",value:function(){this.props.fetchPosts(),this.props.fetchUser()}},{key:"componentDidUpdate",value:function(){var e=this;this.state.alert&&setTimeout((function(){e.setState({alert:!1})}),5e3)}},{key:"renderAlert",value:function(){var e=this.state,t=e.alert,n=e.alertType,a=e.alertText;if(t)return Object(A.jsx)(Y.a,{variant:n,children:a})}},{key:"handleUpdatePost",value:function(){var e=Object(i.a)(o.a.mark((function e(t){var n,a,r,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=this.props.match.params.id,a=t.target.title.value.trim(),r=t.target.content.value.trim(),e.prev=4,e.next=7,d()({headers:{"x-access-token":localStorage.getItem("token")},method:"post",url:"/api/update_post",data:{title:a,content:r,post_id:n}});case 7:s=e.sent,console.log(s),200===s.status?(localStorage.setItem("updatePost",!0),this.props.history.replace("/")):this.setState({alert:!0}),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(4),console.log(e.t0.response),this.setState({alert:!0});case 16:case"end":return e.stop()}}),e,this,[[4,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"renderPostContent",value:function(){var e=this,t=this.props.match.params.id;return this.props.posts.filter((function(e){if(e.id==t)return!0})).map((function(t){return Object(A.jsxs)("div",{className:"content-section",children:[Object(A.jsx)("legend",{className:"border-bottom mb-4",children:t.title}),Object(A.jsxs)(H.a,{onSubmit:function(t){return e.handleUpdatePost(t)},children:[Object(A.jsxs)(H.a.Group,{controlId:"title",children:[Object(A.jsx)(H.a.Label,{children:"Title"}),Object(A.jsx)(H.a.Control,{required:!0,size:"lg",type:"title",defaultValue:t.title})]}),Object(A.jsxs)(H.a.Group,{controlId:"content",children:[Object(A.jsx)(H.a.Label,{children:"Content"}),Object(A.jsx)(H.a.Control,{required:!0,as:"textarea",rows:"10",size:"lg",type:"content",defaultValue:t.content})]}),Object(A.jsx)(q.a,{variant:"outline-info",type:"submit",children:"Update"})]})]},t.id)}))}},{key:"render",value:function(){return Object(A.jsxs)("div",{children:[this.renderAlert(),this.renderPostContent()]})}}]),n}(a.Component),le=Object(h.d)(N.h,Object(j.b)((function(e){return{posts:e.posts.items,user:e.users.item}}),{fetchPosts:K,fetchUser:W}))(ie);function ue(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=(t[0],t[1],Object(a.useState)(!1)),r=Object(l.a)(n,2),s=r[0],c=r[1],u=Object(a.useState)("Something went wrong, please try again later!"),j=Object(l.a)(u,2),h=j[0],m=j[1],p=Object(a.useState)("warning"),b=Object(l.a)(p,2),O=b[0],x=b[1];Object(N.f)();function f(){return(f=Object(i.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=t.target.email.value.trim(),e.prev=2,e.next=5,d()({method:"post",url:"/api/request_reset_email",data:{email:n}});case 5:a=e.sent,console.log(a),200===a.status?(c(!0),x("success"),m("Request Sent! Check Email For Password Reset Link!")):(c(!0),x("warning"),m("Something Went Wrong, Please Try Again Later!")),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0.response),400===e.t0.response.status?(c(!0),x("warning"),m("No User Found By This Email! Try Again!")):(c(!0),x("danger"),m("Something Went Wrong, Please Try Again Later!"));case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}return Object(a.useEffect)((function(){s&&setTimeout((function(){c(!1)}),9e3)})),Object(A.jsxs)("div",{children:[function(){if(s)return Object(A.jsx)(Y.a,{variant:O,children:h})}(),Object(A.jsxs)("div",{className:"content-section",children:[Object(A.jsx)("legend",{className:"border-bottom mb-4",children:"Reset Password"}),Object(A.jsxs)(H.a,{onSubmit:function(e){return function(e){return f.apply(this,arguments)}(e)},children:[Object(A.jsxs)(H.a.Group,{controlId:"email",children:[Object(A.jsx)(H.a.Label,{children:"Email"}),Object(A.jsx)(H.a.Control,{required:!0,size:"lg",type:"email",placeholder:"Account Email"})]}),Object(A.jsx)(q.a,{variant:"outline-info",type:"submit",children:"Request Password Reset"})]})]})]})}function de(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)("Something went wrong, please try again later!"),c=Object(l.a)(s,2),u=c[0],j=c[1],h=Object(a.useState)("warning"),m=Object(l.a)(h,2),p=m[0],b=m[1],O=(Object(N.f)(),Object(N.g)().token);function x(){return(x=Object(i.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=t.target.password.value,e.prev=2,e.next=5,d()({method:"post",url:"/api/reset_password",data:{password:n,token:O}});case 5:a=e.sent,console.log(a),200===a.status?(r(!0),b("success"),j("Password Has Been Reset!")):(r(!0),b("warning"),j("Something Went Wrong, Please Try Again Later!")),e.next=16;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0),r(!0),b("danger"),j("Something Went Wrong, Please Try Again Later!");case 16:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}return Object(a.useEffect)((function(){n&&setTimeout((function(){r(!1)}),5e3)})),Object(A.jsxs)("div",{children:[function(){if(n)return Object(A.jsx)(Y.a,{variant:p,children:u})}(),Object(A.jsxs)("div",{className:"content-section",children:[Object(A.jsx)("legend",{className:"border-bottom mb-4",children:"New Password"}),Object(A.jsxs)(H.a,{onSubmit:function(e){return function(e){return x.apply(this,arguments)}(e)},children:[Object(A.jsxs)(H.a.Group,{controlId:"password",children:[Object(A.jsx)(H.a.Label,{children:"New Password"}),Object(A.jsx)(H.a.Control,{required:!0,size:"lg",type:"password",placeholder:"New Password"})]}),Object(A.jsx)(q.a,{variant:"outline-info",type:"submit",children:"Reset Password"})]})]})]})}var je=n(68);var he=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(!1),c=Object(l.a)(s,2),u=c[0],h=c[1],m=Object(a.useState)("Welcome!"),p=Object(l.a)(m,2),b=p[0],O=p[1],x=localStorage.getItem("loginMessage"),f=localStorage.getItem("token");function g(){return(g=Object(i.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f){e.next=4;break}r(!1),e.next=15;break;case 4:return e.prev=4,e.next=7,d()({method:"get",url:"/api/verify_jwt",headers:{"x-access-token":localStorage.getItem("token")}});case 7:200===e.sent.status?(r(!0),h(!0),O("Login Successful! Welcome Back!")):(console.log("Token is invalid"),localStorage.removeItem("token")),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(4),console.log("could not connect to authorization check"),localStorage.removeItem("token");case 15:case"end":return e.stop()}}),e,null,[[4,11]])})))).apply(this,arguments)}return Object(a.useEffect)((function(){!function(){g.apply(this,arguments)}()}),[n||!f]),Object(A.jsx)(j.a,{store:k,children:Object(A.jsx)(S.a,{children:Object(A.jsxs)("div",{className:"main-body",children:[Object(A.jsx)(U,{authorization:n}),Object(A.jsx)(M.a,{children:Object(A.jsxs)(je.a,{children:[Object(A.jsxs)("div",{className:"col-md-8",children:[function(){if(u&&n&&x)return setTimeout((function(){h(!1),O("Welcome!"),localStorage.removeItem("loginMessage")}),5e3),Object(A.jsx)(Y.a,{className:"alert-home",variant:"success",children:b})}(),Object(A.jsxs)(N.c,{children:[Object(A.jsx)(N.a,{exact:!0,path:"/",children:Object(A.jsx)(te,{alert:u,authorization:n})}),Object(A.jsx)(N.a,{path:"/home",children:Object(A.jsx)(te,{alert:u,authorization:n})}),Object(A.jsx)(N.a,{path:"/user_posts/:username",children:Object(A.jsx)(ae,{})}),Object(A.jsx)(N.a,{path:"/post/:id",children:Object(A.jsx)(ce,{})}),Object(A.jsx)(N.a,{path:"/update/post/:id",children:Object(A.jsx)(le,{})}),Object(A.jsx)(N.a,{path:"/about",children:Object(A.jsx)(L,{})}),Object(A.jsx)(N.a,{path:"/account",children:Object(A.jsx)(Z,{})}),Object(A.jsx)(N.a,{path:"/forgot_password",children:Object(A.jsx)(ue,{})}),Object(A.jsx)(N.a,{path:"/reset_password/:token",children:Object(A.jsx)(de,{})}),Object(A.jsx)(N.a,{path:"/register",children:Object(A.jsx)(G,{})}),Object(A.jsx)(N.a,{path:"/new_post",children:Object(A.jsx)(oe,{})}),Object(A.jsx)(N.a,{path:"/login",children:Object(A.jsx)(V,{})}),Object(A.jsx)(N.a,{path:"/logout",children:Object(A.jsx)(R,{})})]})]}),Object(A.jsx)(B,{})]})})]})})})};s.a.render(Object(A.jsx)(he,{}),document.getElementById("root"))},24:function(e,t,n){},87:function(e,t,n){}},[[115,1,2]]]);
//# sourceMappingURL=main.b2deb854.chunk.js.map